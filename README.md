# Vue2.0全家桶构建717商城

@(vue)[vuex, vue-router, axios]

**717商城**是一个便捷式购物网站，用户无需登录即可浏览商品、购买商品，当你点开网站，后台可以自动分配一个模拟的用户名，这样用户就可以在方便的时候注册，若不想注册及可以一直使用该模拟用户！
 
- **Vue2.0** ：全程使用最新的vue技术，实现前后台分离，使用自己模拟的数据自己就可以先完成一整套的页面效果和逻辑的实现。
- **vuex** ：和vue2.0一起使用的一个vue插件用于管理复杂的后台数据操作。
- **axios** ：用于vue项目获取数据。

-------------------

[TOC]

## vue-cli

> Vue-cli是快速构建这个单页应用的脚手架。

###  Node
在安装Node的情况下，安装vue-cli构建项目的整个骨架。

### 安装流程
``` javascript
	npm install --global vue-cli
	vue init webpack
    npm install 
    npm run dev
```
###配置webpack
webpack.config.js里面有大量的配置项，在使用该项目是，可能要引用一些公共样式或者其他第三方组件的样式或者在vue模板中需要使用scss预编译语言需要配置webpack.config.js的module对象里的rules规则，给他们添加对应的功能！
``` javascript
	  {
        test: /\.css$/,
        loader: 'style-loader!css-loader',
      },
      {
	     test:/\.scss$/,
	     loaders:["style","css","sass"]
      }
```
## Vue-Router

### 路由搭建
**webpack+router**在页面中引入vue,vue-router,用new Vue-Router(),里面穿的对象通过routes键名,里面根据各种页面对象配置各个路由！将配置好的路由使用export default 抛出！
## Vuex
###数据的处理
**state**用于存放数据，业务中的购物车计算，数量的计算，后期地址栏的添加等等。
**mutations**用于方法的调用，改变state里面的数据变化，同步执行。
**actions**和**mutations**配合使用，可以异步获取数据，改变复杂的数据。
##首页
首页存在大量的商品，和一个导航，banner轮播图，头部，尾部，其它页面也可能服用的东西就使用vue的组件化，把它们都拆分了，这样文件更加清晰明了，以后若要修改即可修改组件!
###详情页
点击商品即可进去，商品详情页，点击的时候，使用vue-router跳转页面，同时把该商品的信息带过去，由于商品数量，种类都不确定，这里需要借助vuex的数据管理，在vuex里satte定义一个Detail存放数据的对象，在点击商品的时候进入页面，同时把商品数据给vuex里的Detail对象，在进去详情页的时候，在vue**created**生命周期里获取详情页的数据，从而改变详情页的对应的页面！
###购物车数量变化
购物车数量变化，购物车数量在footer组件，触发事件在goods组件,这里还是需要借助vuex,在商品数据里设置一个记录商品个数的变量，这样改变数据里面的变量，从而改变购物车的数量变化！这里要考虑商品的去重，购物车的数量还会跟着用户的点击，改变数量的变化。这里需要用到在vuex的mutations里面添加一个add方法，及时改变数据的变化和该数据的数量的变化，totle函数用来随时改变数量的变化，同时在state里面声明一个goods的数组，用来及时储存数据，
###去重
利用每个商品都有一个固定的good_id的，判断vuex里面存放购物车数据是否会重复出现，实现这个逻辑需要，准备一个开始flag为true的变量，借着判断goods里面的是否存在数据，若不存在就push进去过来的数据，若存在数据即循环便利数据，即与传过来的good_id做比较，如果存在就改变flag的值，同时为了计算数量，让当前的num++，这样一来即可改变商品数量变化！在循环外面，判断flag值，true即没有重复push进去数据，flag则不做任何操作！
``` javascript
	add(state,num){
			var flag = true
			if(state.data==0){
				state.data.push(num)
			}else{
				state.data.forEach((i,val)=>{
					if(i.id==num.id){
						flag = false
						state.data[val].num++ 
					}
				})
				if(flag){
					state.data.push(num)
				}
			}
		}
```
###计算数量
由于上面改变了，数据本身的变化，这里只需循环便利商品数组，从而计算每个商品的num值，即可得到总数量！
``` javascript
	totle(state,index){
			let num = 0
			state.data.forEach((i,val)=>{
				num +=i.num
			})
			state.all = num
		}
```
##分类页
分类页就比较简单了，只是一个数据请求加载渲染页面，一个简单的tab切换，首先数据分为两部分，一个是菜单页，一个是列表展示，首先获取菜单用数据渲染，然后根据点击不同菜单，传不同的参数和获取对应的列表展示页的数据！
##购物车页
购物车页，页面核心部分之一，它和首页的关联性也很大！Vuex的应用就好好利用，在购物车里面需要计算单个商品的信息，商品总和，删除商品！
###计算单个商品信息
通过vuex改变数据里的商品数量的变，从而可以引起页面的变化！在调用里面的数量和单价的乘积，进行单个数量的计算！
###商品的总和 
通过vuex上面改变了数量的变化！进而计算商品数量的汇总！通过Vuex的mutations的方法页面的刷新！
###删除商品
删除被选中的商品，首先在vuex数据管理里面判断商品里面的状态是否为true或者false，点击时，找到商品为true的商品，将它们从数据里删除即可！
##地址管理
地址管理，根据用户选择的地址唯一默认的，用户添加，编辑、删除！这几个功能开始构造逻辑！本功能需要使用localStrange存储和Vuex之间进行数据的传递！
###用户添加
使用vue**@click**绑定事件，对应的跳转到添加页面，在此同时需要使用**vue-router**进行路由的跳转和参数的传递！用于是添加新用户，这里的参数一定要和编辑用户的区别开！进入编辑页面简单判断用户输入的信息，点击保存，执行数据的传递，通过**this.$store.commit**方法传递给vuex的mutations里的方法进行数据的当前储存和对localStrange的保存！,同时设置路由跳转到编辑页面，在编辑页的**created**,获取添加时localStrange的值，并判断是否存在，在渲染dom结构，若编辑的有内容，则渲染里面收集的用户信息！若没有则为空！
##编辑
点击编辑按钮的时候，也需要跳转路由，同时传递参数，将点击的编辑的所在的下标传递过去，路由跳转之后判断用户是否需要在是要修改还是重新添加用户，若参数里面里有个数字，那将在created里面通过传过来的下标在vuex里取出那个对应的信息，在取出里面的具体资料，渲染到页面中！在此点击保存的时候，向调用vuex里的方法，并传递下标，在vuex里mutations里面对数据进行更换，并再次保存在localStrange中！跳转页面之后，在此获取数据，页面及刷新！
###删除
点击删除按钮，调用vuex里的方法，通过传入的下标，删除数据，在继续保存在localStrange里面，从而做到数据的永久保存在本地存储里面！
###选择默认
默认选项，原理通过vuex里mutations定义一个先获取到所有数据，全部变换为false,在通过通入的下标，改变当前的默认配置值，实现默认选中的操作，这里有一个主意点。若是用户新添加的地址，优先设为默认，这里在用户添加时就要判断，保存时，用户是先添加的还是点击的编辑的，编辑是只用传对应的下标，新增时传，当前保存用户数组的长度减一即可！
